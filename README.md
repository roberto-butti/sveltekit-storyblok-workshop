# Sveltekit Storyblok Workshop

This is the repository for tracking all the processes for creating a sample SvelteKit application with Stroyblok.
The GitHub repository is here: [sveltekit-storyblok-workshop](https://github.com/roberto-butti/sveltekit-storyblok-workshop)

## Install SvelteKit

```shell
# Installing SveteKit base project
npm create svelte@latest sveltekit-storyblok-workshop
# Installing package in the project directory
cd sveltekit-storyblok-workshop
npm install
# Adding local Git
git init && git add -A && git commit -m "Initial commit"
# Running the local web server and open the browser
npm run dev -- --open
```

## Creating Storyblok space

To obtain your access token, you have to [create a new Storyblok space](https://app.storyblok.com/#/me/spaces/new).
You can create a space for free by selecting the "Community plan".

## Configuring the Visual Editor

In the "Settings" section, selecting the "Visual Editor" tab, you can set the `Location (default environment)` with `https://localhost:5173/`

![Visual Editor Settings](doc/settings-visual-editor.png)

## Getting the Access Token

In the "Settings" section, selecting the "Access Tokens" tab, you can get your access token.

![Getting the Access Token](doc/settings-access-token.png)

## Setting the Access token

For setting the access token you can copy the `.env.example` file into `.env` file or in general you have to set the following 2 parameters in the `.env` file:

```
PUBLIC_ACCESS_TOKEN=yourspaceaccesstoken
PUBLIC_REGION=eu
```

These two parameters will be used in the Storyblok connection.

## Enabling HTTPS

To enable the HTTPS protocol, the easiest way is to install the _basicSsl_ plugin:

```sh
npm i --save-dev @vitejs/plugin-basic-ssl
```

In the `vite.config.js` file, you have to use the _basicSsl_ plugin:

```js
import { sveltekit } from '@sveltejs/kit/vite';
import { defineConfig } from 'vite';
//001 import the basicSsl
import basicSsl from '@vitejs/plugin-basic-ssl';

export default defineConfig({
	//002 add basicSsl() in the `plugins` list
	plugins: [sveltekit(), basicSsl()]
});
```

Now, when you run `npm run dev`, the SvelteKit application is served via the default `5173` port and the HTTPS protocol instead of the usual HTTP protocol.

So you can access your application at https://localhost:5173/

> For security reasons, the first time you will access the page via HTTPS protocol, the browser will ask you to accept the self-signed certificate automatically generated by the _basicSsl_ plugin during the bootstrap.

## Installing the Stroyblok Svelte SDK

```
npm install @storyblok/svelte
```

Make sure that the `typescript` and the `svelte-preprocess` packages are installed (in devDependencies).

## Configuring the svelte.config.js file

In the `svelte.config.js` file, make sure you are setting the `preprocess` :

```js
const config = {
	kit: {
		adapter: adapter()
	},
	// 002 setting the preprocess
	preprocess: [vitePreprocess()]
};
```

Make sure that the vitePreprocess is imported:

```js
// 001 import the vitePreprocess
import { vitePreprocess } from '@sveltejs/kit/vite';
```

## Installing TailwindCSS

```shell
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
```

In the `svelte.config.js` make sure that you are loading the `vitePreprocess()` as `preprocess`.

In the `tailwind.config.js` make sure that you are setting `./src/**/*.{html,js,svelte,ts}` as `content` .

Add `app.css` file in `src/` directory and set TailwindCSS directive:

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

## Installing DaisyUI

```shell
 npm i -D daisyui
```
